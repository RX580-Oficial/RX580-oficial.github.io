<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RX580 Pagina Web</title>
    <link rel="stylesheet" href="css/Formulario.css">
</head>
<body>
    <div class="formula">
        <h2>Inicio de Sesión</h2>  
        <form id="loginForm"> <div class="username">
                <input type="text" id="username" name="username" required>
                <label for="username">Nombre de Usuario</label>
            </div>
            <div class="username">
                <input type="password" id="password" name="password" required>
                <label for="password">Contraseña</label>
            </div>
            <div class="recordar">¿Olvidó su Contraseña?</div>
            <input type="submit" value="Iniciar Sesión">
            <div class="registrarse">¿No tienes una cuenta? <a href="Register.html">Regístrate</a></div>
        </form>
    </div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js"; // Import getAuth and signInWithEmailAndPassword

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBxDhX1l674FFjHLb5cdGlP7hYjBrVWc74",
            authDomain: "proplayer-e775e.firebaseapp.com",
            projectId: "proplayer-e775e",
            storageBucket: "proplayer-e775e.firebasestorage.app",
            messagingSenderId: "900441654672",
            appId: "1:900441654672:web:929e94a8af83fb59e69f15",
            measurementId: "G-6BE72NDQLL"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app); // Get the Auth service

        const loginForm = document.getElementById('loginForm');
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault(); // Prevent default form submission

            const email = document.getElementById('username').value; // Assuming 'username' input will be used for email
            const password = document.getElementById('password').value;

            try {
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;
                console.log('Usuario ha iniciado sesión:', user);
                alert('¡Inicio de sesión exitoso!');
                // Redirect to index.html or another page upon successful login
                window.location.href = 'index.html'; 
            } catch (error) {
                const errorCode = error.code;
                const errorMessage = error.message;
                console.error('Error al iniciar sesión:', errorCode, errorMessage);
                alert(`Error al iniciar sesión: ${errorMessage}`);
            }
        });
    </script>
    <script src="js/table.js"></script> 
</body>
</html>